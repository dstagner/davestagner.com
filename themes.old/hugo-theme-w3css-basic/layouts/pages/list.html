{{- define `main` }}
{{- if or $.Site.Params.debug (findRE `\bhtml-comment\b` $.Site.Params.traceFlags) }}
{{ `<!-- pages/list.html (main) -->` | safeHTML }}
{{- end}}
  {{- if $.Site.Params.debug }}pages/list.html{{ end }}

  {{ partial `page.nav.breadcrump.html` . }}
  {{- if or $.Site.Params.debug (findRE `\bhtml-comment\b` $.Site.Params.traceFlags) }}
    {{ `<!-- back in pages/list.html (main) -->` | safeHTML }}
  {{- end}}

  {{ partial `page.nav.cards.html` . }}
  {{- if or $.Site.Params.debug (findRE `\bhtml-comment\b` $.Site.Params.traceFlags) }}
    {{ `<!-- back in pages/list.html (main) -->` | safeHTML }}
  {{- end}}
  {{- if or $.Site.Params.debug (findRE `\bhtml-comment\b` $.Site.Params.traceFlags) }}
    {{ `<!-- range .Data.Pages.ByWeigh  -->` | safeHTML }}
  {{- end}}

  <div id='PagesListContainer' class=' {{ default `w3-theme-l4` ($.Site.Param `colorPagesListContainer`)}} '>

  {{/*- range $index, $element := sort .Data.Pages `.weight` */}}
  {{- range $index, $element := .Data.Pages.ByWeight }}
    {{- if eq (mod $index 3) 0 }}
    {{- if or $.Site.Params.debug (findRE `\bhtml-comment\b` $.Site.Params.traceFlags) }}
      {{ `<!-- modulo 0 -->` | safeHTML }}
    {{- end}}
    <div class="w3-cell-row w3-margin-bottom ">
    {{- end }}

    <div class='w3-cell w3-cell-bottom w3-mobile {{ default `w3-theme-l4` ($.Site.Param `colorPagesListCell`)}} '>
        <div class='w3-card w3-margin-right w3-round w3-hover-shadow w3-opacity-min w3-hover-opacity-off {{ default `w3-theme-l3` ($.Site.Param `colorPagesListCard`)}} '>
        {{ partial `main.teaser_in_card.html` . }}
        {{- if or $.Site.Params.debug (findRE `\bhtml-comment\b` $.Site.Params.traceFlags) }}
          {{ `<!-- back in pages/list.html (main)   -->` | safeHTML }}
        {{- end}}

        </div> {{- if or $.Site.Params.debug (findRE `\bhtml-comment\b` $.Site.Params.traceFlags) }}
                 {{ `<!-- w3-card -->` | safeHTML }}
               {{- end}}
      </div> {{- if or $.Site.Params.debug (findRE `\bhtml-comment\b` $.Site.Params.traceFlags) }}
               {{ `<!-- w3-cell -->` | safeHTML }}
             {{- end}}

    {{- if or (eq (mod $index 3) 2) (eq $index (sub (len $.Data.Pages) 1 )) }}
    {{- if or $.Site.Params.debug (findRE `\bhtml-comment\b` $.Site.Params.traceFlags) }}
      {{ `<!-- last one -->` | safeHTML }}
    {{- end}}

    </div> {{- if or $.Site.Params.debug (findRE `\bhtml-comment\b` $.Site.Params.traceFlags) }}
             {{ `<!-- w3-cell-row -->` | safeHTML }}
           {{- end}}

    {{- end }}{{/* if mod */}}
  {{- end }} {{/* range */}}

  </div> {{- if or $.Site.Params.debug (findRE `\bhtml-comment\b` $.Site.Params.traceFlags) }}
           {{ `<!-- PagesListContainer -->` | safeHTML }}
         {{- end}}

{{- end }} {{/* define */}}
